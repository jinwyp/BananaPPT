<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover">
  <title>Nano PPT Designer Â· Pro Dashboard</title>
  <style>
    /* ä¿æŒæ‚¨æ»¡æ„çš„ Vercel/Linear é£æ ¼ UI */
    :root {
      --bg-dark: #0f1525;
      --panel-bg: rgba(22, 28, 45, 0.6);
      --glass-border: rgba(255, 255, 255, 0.08);
      --accent: #00d2ff;
      --text-main: #e0e0e0;
      --text-muted: #8890a0;
      --radius: 12px;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    
    body {
      margin: 0;
      color: var(--text-main);
      background-color: var(--bg-dark);
      background-image: 
        radial-gradient(circle at 15% 50%, rgba(58, 123, 213, 0.08), transparent 25%),
        radial-gradient(circle at 85% 30%, rgba(0, 210, 255, 0.05), transparent 25%);
      font-family: "PingFang SC", "Helvetica Neue", Helvetica, sans-serif;
      height: 100vh;
      overflow: hidden;
    }

    .app-layout {
      display: grid;
      grid-template-columns: 320px 360px 1fr; 
      gap: 20px;
      height: 100vh;
      padding: 20px;
      max-width: 2400px;
      margin: 0 auto;
    }

    @media (max-width: 1100px) {
      .app-layout { grid-template-columns: 340px 1fr; overflow-y: auto; height: auto; }
      .col-left { grid-column: 1 / -1; order: 2; height: 500px !important; } 
      .col-center { order: 1; }
      .col-right { order: 3; height: 600px !important; }
    }
    @media (max-width: 800px) {
      .app-layout { display: flex; flex-direction: column; padding: 12px; gap: 16px; }
      .col-left, .col-center, .col-right { height: auto !important; max-height: none; overflow: visible; }
    }

    .panel {
      background: var(--panel-bg);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      backdrop-filter: blur(10px);
    }

    .panel-header {
      padding: 16px;
      border-bottom: 1px solid var(--glass-border);
      background: rgba(0,0,0,0.2);
    }
    .panel-header h2 { margin: 0; font-size: 15px; font-weight: 600; color: #fff; letter-spacing: 0.5px; }
    
    .panel-body {
      padding: 16px;
      overflow-y: auto;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    /* å·¦æ  */
    .col-left { height: 100%; }
    .section-title { font-size: 13px; color: var(--accent); margin-bottom: 10px; font-weight: bold; display: flex; justify-content: space-between; align-items: center; }
    
    .style-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .style-card {
      position: relative;
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
      border: 2px solid transparent;
      transition: 0.2s;
      background: #000;
    }
    .style-card.active { border-color: var(--accent); box-shadow: 0 0 0 2px rgba(0, 210, 255, 0.2); }
    .style-card.loading { opacity: 0.5; cursor: wait; } /* åŠ è½½çŠ¶æ€ */
    .style-card img { width: 100%; height: 75px; object-fit: cover; display: block; opacity: 0.7; transition: 0.3s; }
    .style-card:hover img { opacity: 1; }
    .style-card.active img { opacity: 1; }
    
    .style-name {
      position: absolute; bottom: 0; left: 0; right: 0;
      background: rgba(0,0,0,0.7); color: #fff;
      font-size: 11px; padding: 4px; text-align: center;
    }
    .style-actions { position: absolute; top: 4px; right: 4px; display: flex; gap: 4px; }
    .icon-btn {
      width: 20px; height: 20px; background: rgba(0,0,0,0.6); border-radius: 4px;
      color: #fff; display: flex; align-items: center; justify-content: center;
      font-size: 12px; cursor: pointer; transition: 0.2s; border: 1px solid rgba(255,255,255,0.2);
    }
    .icon-btn:hover { background: var(--accent); color: #000; }

    .divider-text { text-align: center; font-size: 12px; color: var(--text-muted); margin: -10px 0 10px; font-style: italic; }

    .upload-area {
      border: 1px dashed var(--glass-border);
      background: rgba(0,0,0,0.2);
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      transition: 0.3s;
      cursor: pointer;
    }
    .upload-area:hover { border-color: var(--text-muted); background: rgba(0,0,0,0.3); }
    .upload-area.active { border-color: var(--accent); background: rgba(0, 210, 255, 0.05); }
    .thumbs { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 10px; }
    .thumb { width: 60px; height: 60px; border-radius: 6px; overflow: hidden; position: relative; border: 1px solid var(--glass-border); }
    .thumb img { width: 100%; height: 100%; object-fit: cover; }
    .thumb .del { position: absolute; inset: 0; background: rgba(0,0,0,0.6); color: #fff; display: flex; align-items: center; justify-content: center; opacity: 0; cursor: pointer; }
    .thumb:hover .del { opacity: 1; }

    /* ä¸­æ  */
    .col-center { height: 100%; }
    label { display: block; font-size: 13px; color: var(--text-muted); margin-bottom: 6px; }
    input[type="text"], textarea, select {
      width: 100%;
      background: rgba(0,0,0,0.3);
      border: 1px solid var(--glass-border);
      color: #fff;
      border-radius: 8px;
      padding: 12px;
      font-size: 14px;
      outline: none;
      transition: 0.3s;
    }
    textarea { min-height: 220px; resize: vertical; line-height: 1.6; }
    input:focus, textarea:focus, select:focus { border-color: var(--accent); background: rgba(0,0,0,0.5); }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }

    .key-section { background: rgba(0,0,0,0.2); padding: 12px; border-radius: 8px; margin-top: auto; }
    .key-label { font-size: 12px; color: var(--text-muted); margin-bottom: 6px; line-height: 1.4; } 
    .key-input-row { display: flex; gap: 6px; }
    .btn-sm { 
      padding: 0 14px; height: 34px; font-size: 13px;
      background: rgba(255,255,255,0.1); border: 1px solid var(--glass-border); 
      color: #ccc; border-radius: 6px; cursor: pointer; white-space: nowrap; flex-shrink: 0;
    }
    .btn-sm:hover { background: rgba(255,255,255,0.2); }

    /* ç”ŸæˆæŒ‰é’®ï¼šç®€æ´ç°ä»£ */
    .btn-generate {
      margin-top: 20px;
      background: var(--accent);
      color: #0f1525;
      border: none;
      height: 48px;
      border-radius: 6px;
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.2s ease;
      box-shadow: none; 
    }
    .btn-generate:hover { filter: brightness(1.1); transform: translateY(-1px); }
    .btn-generate:active { transform: translateY(1px); }
    .btn-generate[disabled] { background: #333; color: #777; cursor: not-allowed; transform: none; filter: none; }

    /* å³æ  */
    .col-right { height: 100%; }
    .status-bar { color: var(--accent); font-size: 13px; text-align: center; min-height: 20px; }
    .result-group { margin-bottom: 24px; animation: fadeIn 0.5s ease; border-bottom: 1px solid var(--glass-border); padding-bottom: 20px; }
    .result-meta { font-size: 12px; color: var(--text-muted); margin-bottom: 10px; display: flex; align-items: center; justify-content: space-between; }
    .grid-imgs { display: flex; flex-wrap: wrap; gap: 12px; }
    .img-card {
      height: 160px; 
      border-radius: 8px; overflow: hidden; border: 1px solid var(--glass-border);
      position: relative; background: #000; transition: 0.2s;
    }
    .img-card:hover { transform: translateY(-3px); border-color: var(--text-muted); }
    .img-card img { height: 100%; width: 100%; object-fit: contain; display: block; }
    .img-actions {
      position: absolute; inset: 0; background: rgba(0,0,0,0.6);
      display: flex; align-items: center; justify-content: center; gap: 10px;
      opacity: 0; transition: 0.2s;
    }
    .img-card:hover .img-actions { opacity: 1; }
    .action-btn {
      width: 32px; height: 32px; border-radius: 50%; background: rgba(255,255,255,0.2);
      border: none; color: #fff; cursor: pointer; display: flex; align-items: center; justify-content: center;
    }
    .action-btn:hover { background: var(--accent); color: #000; }

    /* Lightbox */
    .lightbox { position: fixed; inset: 0; z-index: 1000; background: rgba(0,0,0,0.95); display: none; flex-direction: column; }
    .lightbox.show { display: flex; }
    .lb-header { padding: 15px 20px; display: flex; justify-content: space-between; color: #aaa; }
    .lb-content { flex: 1; display: flex; align-items: center; justify-content: center; padding: 20px; }
    .lb-content img { max-width: 100%; max-height: 100%; box-shadow: 0 0 50px rgba(0,0,0,0.8); }
    .lb-footer { padding: 20px; display: flex; justify-content: center; gap: 20px; }
    
    ::-webkit-scrollbar { width: 5px; height: 5px; }
    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.15); border-radius: 3px; }
    ::-webkit-scrollbar-track { background: transparent; }
    
    @keyframes spin { to { transform: rotate(360deg); } }
    .spinner { width: 18px; height: 18px; border: 2px solid rgba(0,0,0,0.1); border-top-color: #0f1525; border-radius: 50%; animation: spin 0.8s linear infinite; display: none; }
    .btn-copy { background: transparent; border: 1px solid #444; color: #888; border-radius: 4px; padding: 2px 6px; font-size: 11px; cursor: pointer; }
    .btn-copy:hover { border-color: var(--accent); color: var(--accent); }
  </style>
</head>
<body>

<div class="app-layout">
  <!-- å·¦æ ï¼šèµ„æºé€‰æ‹© -->
  <aside class="panel col-left">
    <div class="panel-header"><h2>1. é€‰æ‹©PPTé£æ ¼</h2></div>
    <div class="panel-body">
      <div>
        <div class="section-title">é¢„è®¾PPTé£æ ¼<span style="font-weight:normal; font-size:11px; opacity:0.7"> </span></div>
        <div class="style-grid" id="styleList"></div>
      </div>
      <div class="divider-text">-- æˆ–è€…åœ¨ä¸‹æ–¹ä¸Šä¼ è‡ªå·±çš„é£æ ¼å‚è€ƒå›¾ --</div>
      <div>
        <div class="section-title">è‡ªå®šä¹‰å‚è€ƒå›¾<span style="font-weight:normal; font-size:11px; opacity:0.7"> </span></div>
        <div class="upload-area" id="dropArea">
          <div style="font-size: 24px; margin-bottom: 8px; color: var(--text-muted);">+</div>
          <div style="font-size: 12px; color: var(--text-muted);">ç‚¹å‡»æˆ–æ‹–å…¥å›¾ç‰‡ï¼Œæœ€å¤š8å¼ </div>
          <input id="fileInput" type="file" accept="image/*" multiple hidden>
        </div>
        <div id="thumbs" class="thumbs"></div>
      </div>
    </div>
  </aside>

  <!-- ä¸­æ ï¼šæ§åˆ¶å° -->
  <main class="panel col-center">
    <div class="panel-header"><h2>2. è¾“å…¥PPTå†…å®¹</h2></div>
    <div class="panel-body">
      <div>
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px">
          <label style="margin:0">è¾“å…¥æç¤ºè¯</label>
          <label style="display:flex; align-items:center; gap:6px; cursor:pointer; font-size:12px; color:var(--text-muted)">
            <input type="checkbox" id="enhancementToggle" checked> æç¤ºè¯å¢å¼º
          </label>
        </div>
        <textarea id="prompt" placeholder="è¾“å…¥PPTçš„å†…å®¹å’Œé£æ ¼è¦æ±‚ã€‚å†…å®¹å¯ä»¥è¾“å…¥éå¸¸éå¸¸å¤šçš„æ–‡å­—ï¼Œ2000å­—ä¹Ÿå®Œå…¨æ²¡é—®é¢˜ã€‚å¦‚æœè¾“å…¥çš„æ–‡å­—å¤ªå°‘ï¼ŒAIä¼šè‡ªåŠ¨å¡«å……å†…å®¹ã€‚é£æ ¼å¯ä»¥ä½¿ç”¨æ–‡å­—æè¿°ï¼Œå¦‚æœé€‰æ‹©äº†é£æ ¼æˆ–ä¸Šä¼ äº†å‚è€ƒå›¾ï¼Œä¸æè¿°ä¹Ÿæ²¡é—®é¢˜ã€‚"></textarea>
      </div>
      <div class="form-row">
        <div>
          <label>ç”»å¹…æ¯”ä¾‹</label>
          <select id="ratioSelect">
            <option value="">è‡ªåŠ¨</option>
            <option value="16:9" selected>16:9</option>
            <option value="4:3">4:3</option>
            <option value="1:1">1:1</option>
            <option value="9:16">9:16</option>
            <option value="3:4">3:4</option>
            <option value="3:2">3:2</option>
            <option value="2:3">2:3</option>
            <option value="5:4">5:4</option>
            <option value="4:5">4:5</option>
            <option value="21:9">21:9</option>
          </select>
        </div>
        <div>
          <label>åˆ†è¾¨ç‡</label>
          <select id="sizeSelect">
            <option value="1K">1K æ ‡å‡†</option>
            <option value="2K">2K é«˜æ¸…</option>
            <option value="4K" selected>4K è¶…æ¸…</option>
          </select>
        </div>
      </div>
      <div style="flex:1"></div> 
      <div class="status-bar" id="status"></div>
      <div class="key-section">
        <div class="key-label">API Key (è”ç³»ä½œè€…å¾®ä¿¡ <b>duge360</b> è´­ä¹°ï¼Œæ¯æ¬¡0.2å…ƒï¼Œä»·æ ¼å¯èƒ½å˜åŠ¨)</div>
        <div class="key-input-row">
          <input type="text" id="userKey" placeholder="sk-..." style="height:34px;">
          <button class="btn-sm" id="saveKey">ä¿å­˜</button>
        </div>
      </div>
      <button class="btn-generate" id="go">
        <span class="spinner" id="spin"></span>
        <span id="btnText">ç«‹å³ç”Ÿæˆ</span>
      </button>
    </div>
  </main>

  <!-- å³æ ï¼šç”»å»Š -->
  <aside class="panel col-right">
    <div class="panel-header">
      <div style="display:flex; justify-content:space-between; align-items:center">
        <h2>3. ç”Ÿæˆç»“æœ</h2>
        <span style="font-size:12px; color:var(--text-muted)">é¢„è§ˆ/ä¸‹è½½</span>
      </div>
    </div>
    <div class="panel-body" id="gallery"></div>
  </aside>
</div>

<!-- Lightbox -->
<div class="lightbox" id="lightbox">
  <div class="lb-header">
    <span id="lbInfo">é¢„è§ˆ</span>
    <span style="cursor:pointer" onclick="closeLightbox()">âœ• å…³é—­</span>
  </div>
  <div class="lb-content" onclick="closeLightbox()">
    <img id="lbImg" src="" onclick="event.stopPropagation()">
  </div>
  <div class="lb-footer">
    <button class="btn-sm" onclick="downloadCurrent()" id="lbDownBtn" style="display:none">ä¸‹è½½åŸå›¾</button>
  </div>
</div>

<script>
;(() => {
  // ========================================================
  // ğŸŸ¢ é£æ ¼é…ç½®åŒº (ç»´æŠ¤è¿™é‡Œ)
  // preview: ç½‘ç«™ä¸Šå±•ç¤ºçš„é¢„è§ˆå›¾ (1å¼ )
  // refs:    å¹•åå‘é€ç»™ AI çš„å‚è€ƒå›¾ç‰‡ç»„ (å¤šå¼ ï¼Œå»ºè®®æ”¾åœ¨å­æ–‡ä»¶å¤¹)
  // ========================================================
  const PPT_STYLES = [
    {
      id: 'leader_love',
      title: 'é¢†å¯¼æœ€çˆ±',
      preview: './styles/leader_love/preview.png',
      refs: [
        './styles/leader_love/ref1.png',
        './styles/leader_love/ref2.png',
        './styles/leader_love/ref3.png',
        './styles/leader_love/ref4.png',
        './styles/leader_love/ref5.png',
        './styles/leader_love/ref6.png',
        './styles/leader_love/ref7.png',
        './styles/leader_love/ref8.png'
      ],
      suffix: '---ä»¥ä¸Šæ˜¯ç”¨æˆ·è¾“å…¥çš„ç”ŸæˆPPTçš„æç¤ºè¯ã€‚ä»¥ä¸‹æ˜¯ä½ è¦éµå¾ªçš„ç³»ç»Ÿæç¤ºè¯ï¼šè¯·å¸®ç”¨æˆ·ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œç”¨æˆ·ä¼šæŠŠè¿™ä¸ªå›¾ç‰‡ç›´æ¥æ’å…¥åˆ°PPTé‡Œï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¯´æ˜ï¼Œé»˜è®¤ä½¿ç”¨ä¸­æ–‡ã€‚ä½ éœ€è¦å‚è€ƒé£æ ¼å›¾çš„é¢œè‰²ä¸è‰²å½©é£æ ¼ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç»“åˆç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ç”ŸæˆPPTï¼Œç”¨å¹³é¢è®¾è®¡ä¸“å®¶çš„è§’åº¦ï¼Œé‡‡ç”¨ç¾è§‚çš„å›¾æ ‡ä»¥åŠç´§å‡‘çš„å¸ƒå±€ï¼Œéµå¾ªæœ€ä½³çš„å¹³é¢è®¾è®¡åŸç†ï¼Œæ–‡å­—ä¸èƒ½è¢«å‹æ‰æˆ–ç¼©çª„ã€‚è¯·ä½ ç›´æ¥ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œè¾¹ç¼˜ä¸è¦æœ‰å¤šä½™çš„è¾¹æ¡†æˆ–è€…æ˜¯ç™½è¾¹ï¼Œ4kåˆ†è¾¨ç‡ã€‚å½“å‰éœ€è¦ç”Ÿæˆçš„é¡µé¢å†…å®¹ï¼šå¦‚æœç”¨æˆ·çš„æç¤ºè¯éå¸¸è¯¦å®ï¼Œç›´æ¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„å†…å®¹æ¥ç”ŸæˆPPTï¼›å¦‚æœç”¨æˆ·çš„æç¤ºè¯è¿‡äºç®€å•ï¼Œä¸è¶³ä»¥ç”Ÿæˆç´§å‡‘ã€å†…å®¹å……å®çš„PPTï¼Œè¯·å…ˆä½¿ç”¨ä½ çš„ä¸“ä¸šçŸ¥è¯†å®Œå–„PPTçš„ä¸»é¢˜å†…å®¹ï¼Œå†ç”Ÿæˆæœ€ç»ˆçš„PPTã€‚æ— è®ºå“ªç§åœºæ™¯ï¼Œéƒ½è¦å®Œå…¨ä½¿ç”¨ç”¨æˆ·æä¾›çš„æ•°æ®å’Œä¸“ä¸šåè¯ï¼Œä¸è¦è‡ªå·±ç¼–é€ æ•°æ®ã€‚ä½ éœ€è¦è¿”å›3å¼ å›¾ç‰‡ï¼Œç¬¬1å¼ æ˜¯å®Œæ•´çš„PPTå†…å®¹ï¼›ç¬¬2å¼ æ˜¯PPTé‡Œæ‰€æœ‰çš„å›¾åƒå’ŒèƒŒæ™¯å›¾çš„ç»„åˆï¼Œæ²¡æœ‰ä»»ä½•æ–‡å­—ï¼›ç¬¬3å¼ æ˜¯PPTé‡Œçš„æ‰€æœ‰æ–‡å­—ï¼Œé€æ˜èƒŒæ™¯ã€‚'
    },
    {
      id: 'data_vision',
      title: 'æ•°æ®å¯è§†åŒ–',
      preview: './styles/data_vision/preview.png',
      refs: [
        './styles/data_vision/ref1.png',
        './styles/data_vision/ref2.png',
        './styles/data_vision/ref3.png',
        './styles/data_vision/ref4.png',
        './styles/data_vision/ref5.png',
        './styles/data_vision/ref6.png',
        './styles/data_vision/ref7.png',
        './styles/data_vision/ref8.png'
      ],
      suffix: '---ä»¥ä¸Šæ˜¯ç”¨æˆ·è¾“å…¥çš„ç”ŸæˆPPTçš„æç¤ºè¯ã€‚ä»¥ä¸‹æ˜¯ä½ è¦éµå¾ªçš„ç³»ç»Ÿæç¤ºè¯ï¼šè¯·å¸®ç”¨æˆ·ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œç”¨æˆ·ä¼šæŠŠè¿™ä¸ªå›¾ç‰‡ç›´æ¥æ’å…¥åˆ°PPTé‡Œï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¯´æ˜ï¼Œé»˜è®¤ä½¿ç”¨ä¸­æ–‡ã€‚ä½ éœ€è¦å‚è€ƒé£æ ¼å›¾çš„é¢œè‰²ä¸è‰²å½©é£æ ¼ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç»“åˆç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ç”ŸæˆPPTï¼Œç”¨å¹³é¢è®¾è®¡ä¸“å®¶çš„è§’åº¦ï¼Œé‡‡ç”¨ç¾è§‚çš„å›¾æ ‡ä»¥åŠç´§å‡‘çš„å¸ƒå±€ï¼Œéµå¾ªæœ€ä½³çš„å¹³é¢è®¾è®¡åŸç†ï¼Œæ–‡å­—ä¸èƒ½è¢«å‹æ‰æˆ–ç¼©çª„ï¼Œç€é‡ç”Ÿæˆæ•°æ®å›¾è¡¨ï¼Œè¦æ±‚æ•°æ®å‡†ç¡®ã€å›¾è¡¨å¤§æ°”æ•´é½ã€‚è¯·ä½ ç›´æ¥ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œè¾¹ç¼˜ä¸è¦æœ‰å¤šä½™çš„è¾¹æ¡†æˆ–è€…æ˜¯ç™½è¾¹ï¼Œ4kåˆ†è¾¨ç‡ã€‚å½“å‰éœ€è¦ç”Ÿæˆçš„é¡µé¢å†…å®¹ï¼šå¦‚æœç”¨æˆ·çš„æç¤ºè¯éå¸¸è¯¦å®ï¼Œç›´æ¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„å†…å®¹æ¥ç”ŸæˆPPTï¼›å¦‚æœç”¨æˆ·çš„æç¤ºè¯è¿‡äºç®€å•ï¼Œä¸è¶³ä»¥ç”Ÿæˆç´§å‡‘ã€å†…å®¹å……å®çš„PPTï¼Œè¯·å…ˆä½¿ç”¨ä½ çš„ä¸“ä¸šçŸ¥è¯†å®Œå–„PPTçš„ä¸»é¢˜å†…å®¹ï¼Œå†ç”Ÿæˆæœ€ç»ˆçš„PPTã€‚æ— è®ºå“ªç§åœºæ™¯ï¼Œéƒ½è¦å®Œå…¨ä½¿ç”¨ç”¨æˆ·æä¾›çš„æ•°æ®å’Œä¸“ä¸šåè¯ï¼Œä¸è¦è‡ªå·±ç¼–é€ æ•°æ®ã€‚ä½ éœ€è¦è¿”å›3å¼ å›¾ç‰‡ï¼Œç¬¬1å¼ æ˜¯å®Œæ•´çš„PPTå†…å®¹ï¼›ç¬¬2å¼ æ˜¯PPTé‡Œæ‰€æœ‰çš„å›¾åƒå’ŒèƒŒæ™¯å›¾çš„ç»„åˆï¼Œæ²¡æœ‰ä»»ä½•æ–‡å­—ï¼›ç¬¬3å¼ æ˜¯PPTé‡Œçš„æ‰€æœ‰æ–‡å­—ï¼Œé€æ˜èƒŒæ™¯ã€‚'
    },
    {
      id: 'work_result',
      title: 'å·¥ä½œæ±‡æŠ¥',
      preview: './styles/work_result/preview.png',
      refs: [
        './styles/work_result/ref1.png',
        './styles/work_result/ref2.png',
        './styles/work_result/ref3.png',
        './styles/work_result/ref4.png',
        './styles/work_result/ref5.png',
        './styles/work_result/ref6.png',
        './styles/work_result/ref7.png',
        './styles/work_result/ref8.png'
      ],
      suffix: '---ä»¥ä¸Šæ˜¯ç”¨æˆ·è¾“å…¥çš„ç”ŸæˆPPTçš„æç¤ºè¯ã€‚ä»¥ä¸‹æ˜¯ä½ è¦éµå¾ªçš„ç³»ç»Ÿæç¤ºè¯ï¼šè¯·å¸®ç”¨æˆ·ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œç”¨æˆ·ä¼šæŠŠè¿™ä¸ªå›¾ç‰‡ç›´æ¥æ’å…¥åˆ°PPTé‡Œï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¯´æ˜ï¼Œé»˜è®¤ä½¿ç”¨ä¸­æ–‡ã€‚ä½ éœ€è¦å‚è€ƒé£æ ¼å›¾çš„é¢œè‰²ä¸è‰²å½©é£æ ¼ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç»“åˆç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ç”ŸæˆPPTï¼Œç”¨å¹³é¢è®¾è®¡ä¸“å®¶çš„è§’åº¦ï¼Œé‡‡ç”¨ç¾è§‚çš„å›¾æ ‡ä»¥åŠç´§å‡‘çš„å¸ƒå±€ï¼Œéµå¾ªæœ€ä½³çš„å¹³é¢è®¾è®¡åŸç†ï¼Œæ–‡å­—ä¸èƒ½è¢«å‹æ‰æˆ–ç¼©çª„ã€‚è¯·ä½ ç›´æ¥ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œè¾¹ç¼˜ä¸è¦æœ‰å¤šä½™çš„è¾¹æ¡†æˆ–è€…æ˜¯ç™½è¾¹ï¼Œ4kåˆ†è¾¨ç‡ã€‚å½“å‰éœ€è¦ç”Ÿæˆçš„é¡µé¢å†…å®¹ï¼šå¦‚æœç”¨æˆ·çš„æç¤ºè¯éå¸¸è¯¦å®ï¼Œç›´æ¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„å†…å®¹æ¥ç”ŸæˆPPTï¼›å¦‚æœç”¨æˆ·çš„æç¤ºè¯è¿‡äºç®€å•ï¼Œä¸è¶³ä»¥ç”Ÿæˆç´§å‡‘ã€å†…å®¹å……å®çš„PPTï¼Œè¯·å…ˆä½¿ç”¨ä½ çš„ä¸“ä¸šçŸ¥è¯†å®Œå–„PPTçš„ä¸»é¢˜å†…å®¹ï¼Œå†ç”Ÿæˆæœ€ç»ˆçš„PPTã€‚æ— è®ºå“ªç§åœºæ™¯ï¼Œéƒ½è¦å®Œå…¨ä½¿ç”¨ç”¨æˆ·æä¾›çš„æ•°æ®å’Œä¸“ä¸šåè¯ï¼Œä¸è¦è‡ªå·±ç¼–é€ æ•°æ®ã€‚ä½ éœ€è¦è¿”å›3å¼ å›¾ç‰‡ï¼Œç¬¬1å¼ æ˜¯å®Œæ•´çš„PPTå†…å®¹ï¼›ç¬¬2å¼ æ˜¯PPTé‡Œæ‰€æœ‰çš„å›¾åƒå’ŒèƒŒæ™¯å›¾çš„ç»„åˆï¼Œæ²¡æœ‰ä»»ä½•æ–‡å­—ï¼›ç¬¬3å¼ æ˜¯PPTé‡Œçš„æ‰€æœ‰æ–‡å­—ï¼Œé€æ˜èƒŒæ™¯ã€‚'
    },
    {
      id: 'red_blue_project',
      title: 'çº¢è“é¡¹ç›®æ±‡æŠ¥',
      preview: './styles/red_blue_project/preview.png',
      refs: [
        './styles/red_blue_project/ref1.png',
        './styles/red_blue_project/ref2.png',
        './styles/red_blue_project/ref3.png',
        './styles/red_blue_project/ref4.png',
        './styles/red_blue_project/ref5.png',
        './styles/red_blue_project/ref6.png'
      ],
      suffix: '---ä»¥ä¸Šæ˜¯ç”¨æˆ·è¾“å…¥çš„ç”ŸæˆPPTçš„æç¤ºè¯ã€‚ä»¥ä¸‹æ˜¯ä½ è¦éµå¾ªçš„ç³»ç»Ÿæç¤ºè¯ï¼šè¯·å¸®ç”¨æˆ·ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œç”¨æˆ·ä¼šæŠŠè¿™ä¸ªå›¾ç‰‡ç›´æ¥æ’å…¥åˆ°PPTé‡Œï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¯´æ˜ï¼Œé»˜è®¤ä½¿ç”¨ä¸­æ–‡ã€‚ä½ éœ€è¦å‚è€ƒé£æ ¼å›¾çš„é¢œè‰²ä¸è‰²å½©é£æ ¼ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç»“åˆç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ç”ŸæˆPPTï¼Œç”¨å¹³é¢è®¾è®¡ä¸“å®¶çš„è§’åº¦ï¼Œé‡‡ç”¨ç¾è§‚çš„å›¾æ ‡ä»¥åŠç´§å‡‘çš„å¸ƒå±€ï¼Œéµå¾ªæœ€ä½³çš„å¹³é¢è®¾è®¡åŸç†ï¼Œæ–‡å­—ä¸èƒ½è¢«å‹æ‰æˆ–ç¼©çª„ã€‚è¯·ä½ ç›´æ¥ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œè¾¹ç¼˜ä¸è¦æœ‰å¤šä½™çš„è¾¹æ¡†æˆ–è€…æ˜¯ç™½è¾¹ï¼Œ4kåˆ†è¾¨ç‡ã€‚å½“å‰éœ€è¦ç”Ÿæˆçš„é¡µé¢å†…å®¹ï¼šå¦‚æœç”¨æˆ·çš„æç¤ºè¯éå¸¸è¯¦å®ï¼Œç›´æ¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„å†…å®¹æ¥ç”ŸæˆPPTï¼›å¦‚æœç”¨æˆ·çš„æç¤ºè¯è¿‡äºç®€å•ï¼Œä¸è¶³ä»¥ç”Ÿæˆç´§å‡‘ã€å†…å®¹å……å®çš„PPTï¼Œè¯·å…ˆä½¿ç”¨ä½ çš„ä¸“ä¸šçŸ¥è¯†å®Œå–„PPTçš„ä¸»é¢˜å†…å®¹ï¼Œå†ç”Ÿæˆæœ€ç»ˆçš„PPTã€‚æ— è®ºå“ªç§åœºæ™¯ï¼Œéƒ½è¦å®Œå…¨ä½¿ç”¨ç”¨æˆ·æä¾›çš„æ•°æ®å’Œä¸“ä¸šåè¯ï¼Œä¸è¦è‡ªå·±ç¼–é€ æ•°æ®ã€‚ä½ éœ€è¦è¿”å›3å¼ å›¾ç‰‡ï¼Œç¬¬1å¼ æ˜¯å®Œæ•´çš„PPTå†…å®¹ï¼›ç¬¬2å¼ æ˜¯PPTé‡Œæ‰€æœ‰çš„å›¾åƒå’ŒèƒŒæ™¯å›¾çš„ç»„åˆï¼Œæ²¡æœ‰ä»»ä½•æ–‡å­—ï¼›ç¬¬3å¼ æ˜¯PPTé‡Œçš„æ‰€æœ‰æ–‡å­—ï¼Œé€æ˜èƒŒæ™¯ã€‚'
    },
    {
      id: 'red_grey_project',
      title: 'çº¢ç°é¡¹ç›®æ±‡æŠ¥',
      preview: './styles/red_grey_project/preview.png',
      refs: [
        './styles/red_grey_project/ref1.png',
        './styles/red_grey_project/ref2.png',
        './styles/red_grey_project/ref3.png',
        './styles/red_grey_project/ref4.png',
        './styles/red_grey_project/ref5.png',
        './styles/red_grey_project/ref6.png',
        './styles/red_grey_project/ref7.png'
      ],
      suffix: '---ä»¥ä¸Šæ˜¯ç”¨æˆ·è¾“å…¥çš„ç”ŸæˆPPTçš„æç¤ºè¯ã€‚ä»¥ä¸‹æ˜¯ä½ è¦éµå¾ªçš„ç³»ç»Ÿæç¤ºè¯ï¼šè¯·å¸®ç”¨æˆ·ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œç”¨æˆ·ä¼šæŠŠè¿™ä¸ªå›¾ç‰‡ç›´æ¥æ’å…¥åˆ°PPTé‡Œï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¯´æ˜ï¼Œé»˜è®¤ä½¿ç”¨ä¸­æ–‡ã€‚ä½ éœ€è¦å‚è€ƒé£æ ¼å›¾çš„é¢œè‰²ä¸è‰²å½©é£æ ¼ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç»“åˆç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ç”ŸæˆPPTï¼Œç”¨å¹³é¢è®¾è®¡ä¸“å®¶çš„è§’åº¦ï¼Œé‡‡ç”¨ç¾è§‚çš„å›¾æ ‡ä»¥åŠç´§å‡‘çš„å¸ƒå±€ï¼Œéµå¾ªæœ€ä½³çš„å¹³é¢è®¾è®¡åŸç†ï¼Œæ–‡å­—ä¸èƒ½è¢«å‹æ‰æˆ–ç¼©çª„ã€‚è¯·ä½ ç›´æ¥ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œè¾¹ç¼˜ä¸è¦æœ‰å¤šä½™çš„è¾¹æ¡†æˆ–è€…æ˜¯ç™½è¾¹ï¼Œ4kåˆ†è¾¨ç‡ã€‚å½“å‰éœ€è¦ç”Ÿæˆçš„é¡µé¢å†…å®¹ï¼šå¦‚æœç”¨æˆ·çš„æç¤ºè¯éå¸¸è¯¦å®ï¼Œç›´æ¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„å†…å®¹æ¥ç”ŸæˆPPTï¼›å¦‚æœç”¨æˆ·çš„æç¤ºè¯è¿‡äºç®€å•ï¼Œä¸è¶³ä»¥ç”Ÿæˆç´§å‡‘ã€å†…å®¹å……å®çš„PPTï¼Œè¯·å…ˆä½¿ç”¨ä½ çš„ä¸“ä¸šçŸ¥è¯†å®Œå–„PPTçš„ä¸»é¢˜å†…å®¹ï¼Œå†ç”Ÿæˆæœ€ç»ˆçš„PPTã€‚æ— è®ºå“ªç§åœºæ™¯ï¼Œéƒ½è¦å®Œå…¨ä½¿ç”¨ç”¨æˆ·æä¾›çš„æ•°æ®å’Œä¸“ä¸šåè¯ï¼Œä¸è¦è‡ªå·±ç¼–é€ æ•°æ®ã€‚ä½ éœ€è¦è¿”å›3å¼ å›¾ç‰‡ï¼Œç¬¬1å¼ æ˜¯å®Œæ•´çš„PPTå†…å®¹ï¼›ç¬¬2å¼ æ˜¯PPTé‡Œæ‰€æœ‰çš„å›¾åƒå’ŒèƒŒæ™¯å›¾çš„ç»„åˆï¼Œæ²¡æœ‰ä»»ä½•æ–‡å­—ï¼›ç¬¬3å¼ æ˜¯PPTé‡Œçš„æ‰€æœ‰æ–‡å­—ï¼Œé€æ˜èƒŒæ™¯ã€‚'
    },
    {
      id: 'red_tech',
      title: 'çº¢è‰²ç§‘æŠ€',
      preview: './styles/red_tech/preview.png',
      refs: [
        './styles/red_tech/ref1.png',
        './styles/red_tech/ref2.png',
        './styles/red_tech/ref3.png',
        './styles/red_tech/ref4.png',
        './styles/red_tech/ref5.png',
        './styles/red_tech/ref6.png'
      ],
      suffix: '---ä»¥ä¸Šæ˜¯ç”¨æˆ·è¾“å…¥çš„ç”ŸæˆPPTçš„æç¤ºè¯ã€‚ä»¥ä¸‹æ˜¯ä½ è¦éµå¾ªçš„ç³»ç»Ÿæç¤ºè¯ï¼šè¯·å¸®ç”¨æˆ·ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œç”¨æˆ·ä¼šæŠŠè¿™ä¸ªå›¾ç‰‡ç›´æ¥æ’å…¥åˆ°PPTé‡Œï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¯´æ˜ï¼Œé»˜è®¤ä½¿ç”¨ä¸­æ–‡ã€‚ä½ éœ€è¦å‚è€ƒé£æ ¼å›¾çš„é¢œè‰²ä¸è‰²å½©é£æ ¼ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç»“åˆç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ç”ŸæˆPPTï¼Œç”¨å¹³é¢è®¾è®¡ä¸“å®¶çš„è§’åº¦ï¼Œé‡‡ç”¨ç¾è§‚çš„å›¾æ ‡ä»¥åŠç´§å‡‘çš„å¸ƒå±€ï¼Œéµå¾ªæœ€ä½³çš„å¹³é¢è®¾è®¡åŸç†ï¼Œæ–‡å­—ä¸èƒ½è¢«å‹æ‰æˆ–ç¼©çª„ã€‚è¯·ä½ ç›´æ¥ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œè¾¹ç¼˜ä¸è¦æœ‰å¤šä½™çš„è¾¹æ¡†æˆ–è€…æ˜¯ç™½è¾¹ï¼Œ4kåˆ†è¾¨ç‡ã€‚å½“å‰éœ€è¦ç”Ÿæˆçš„é¡µé¢å†…å®¹ï¼šå¦‚æœç”¨æˆ·çš„æç¤ºè¯éå¸¸è¯¦å®ï¼Œç›´æ¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„å†…å®¹æ¥ç”ŸæˆPPTï¼›å¦‚æœç”¨æˆ·çš„æç¤ºè¯è¿‡äºç®€å•ï¼Œä¸è¶³ä»¥ç”Ÿæˆç´§å‡‘ã€å†…å®¹å……å®çš„PPTï¼Œè¯·å…ˆä½¿ç”¨ä½ çš„ä¸“ä¸šçŸ¥è¯†å®Œå–„PPTçš„ä¸»é¢˜å†…å®¹ï¼Œå†ç”Ÿæˆæœ€ç»ˆçš„PPTã€‚æ— è®ºå“ªç§åœºæ™¯ï¼Œéƒ½è¦å®Œå…¨ä½¿ç”¨ç”¨æˆ·æä¾›çš„æ•°æ®å’Œä¸“ä¸šåè¯ï¼Œä¸è¦è‡ªå·±ç¼–é€ æ•°æ®ã€‚ä½ éœ€è¦è¿”å›3å¼ å›¾ç‰‡ï¼Œç¬¬1å¼ æ˜¯å®Œæ•´çš„PPTå†…å®¹ï¼›ç¬¬2å¼ æ˜¯PPTé‡Œæ‰€æœ‰çš„å›¾åƒå’ŒèƒŒæ™¯å›¾çš„ç»„åˆï¼Œæ²¡æœ‰ä»»ä½•æ–‡å­—ï¼›ç¬¬3å¼ æ˜¯PPTé‡Œçš„æ‰€æœ‰æ–‡å­—ï¼Œé€æ˜èƒŒæ™¯ã€‚'
    },
    {
      id: 'scholar',
      title: 'å­¦æœ¯',
      preview: './styles/scholar/preview.png',
      refs: [
        './styles/scholar/ref1.png',
        './styles/scholar/ref2.png',
        './styles/scholar/ref3.png',
        './styles/scholar/ref4.png',
        './styles/scholar/ref5.png',
        './styles/scholar/ref6.png'
      ],
      suffix: '---ä»¥ä¸Šæ˜¯ç”¨æˆ·è¾“å…¥çš„ç”ŸæˆPPTçš„æç¤ºè¯ã€‚ä»¥ä¸‹æ˜¯ä½ è¦éµå¾ªçš„ç³»ç»Ÿæç¤ºè¯ï¼šè¯·å¸®ç”¨æˆ·ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œç”¨æˆ·ä¼šæŠŠè¿™ä¸ªå›¾ç‰‡ç›´æ¥æ’å…¥åˆ°PPTé‡Œï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¯´æ˜ï¼Œé»˜è®¤ä½¿ç”¨ä¸­æ–‡ã€‚ä½ éœ€è¦å‚è€ƒé£æ ¼å›¾çš„é¢œè‰²ä¸è‰²å½©é£æ ¼ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç»“åˆç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ç”ŸæˆPPTï¼Œç”¨å¹³é¢è®¾è®¡ä¸“å®¶çš„è§’åº¦ï¼Œé‡‡ç”¨ç¾è§‚çš„å›¾æ ‡ä»¥åŠç´§å‡‘çš„å¸ƒå±€ï¼Œéµå¾ªæœ€ä½³çš„å¹³é¢è®¾è®¡åŸç†ï¼Œæ–‡å­—ä¸èƒ½è¢«å‹æ‰æˆ–ç¼©çª„ã€‚è¯·ä½ ç›´æ¥ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œè¾¹ç¼˜ä¸è¦æœ‰å¤šä½™çš„è¾¹æ¡†æˆ–è€…æ˜¯ç™½è¾¹ï¼Œ4kåˆ†è¾¨ç‡ã€‚å½“å‰éœ€è¦ç”Ÿæˆçš„é¡µé¢å†…å®¹ï¼šå¦‚æœç”¨æˆ·çš„æç¤ºè¯éå¸¸è¯¦å®ï¼Œç›´æ¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„å†…å®¹æ¥ç”ŸæˆPPTï¼›å¦‚æœç”¨æˆ·çš„æç¤ºè¯è¿‡äºç®€å•ï¼Œä¸è¶³ä»¥ç”Ÿæˆç´§å‡‘ã€å†…å®¹å……å®çš„PPTï¼Œè¯·å…ˆä½¿ç”¨ä½ çš„ä¸“ä¸šçŸ¥è¯†å®Œå–„PPTçš„ä¸»é¢˜å†…å®¹ï¼Œå†ç”Ÿæˆæœ€ç»ˆçš„PPTã€‚æ— è®ºå“ªç§åœºæ™¯ï¼Œéƒ½è¦å®Œå…¨ä½¿ç”¨ç”¨æˆ·æä¾›çš„æ•°æ®å’Œä¸“ä¸šåè¯ï¼Œä¸è¦è‡ªå·±ç¼–é€ æ•°æ®ã€‚ä½ éœ€è¦è¿”å›3å¼ å›¾ç‰‡ï¼Œç¬¬1å¼ æ˜¯å®Œæ•´çš„PPTå†…å®¹ï¼›ç¬¬2å¼ æ˜¯PPTé‡Œæ‰€æœ‰çš„å›¾åƒå’ŒèƒŒæ™¯å›¾çš„ç»„åˆï¼Œæ²¡æœ‰ä»»ä½•æ–‡å­—ï¼›ç¬¬3å¼ æ˜¯PPTé‡Œçš„æ‰€æœ‰æ–‡å­—ï¼Œé€æ˜èƒŒæ™¯ã€‚'
    },
    {
      id: 'scholar_green',
      title: 'ç»¿è‰²å­¦æœ¯',
      preview: './styles/scholar_green/preview.png',
      refs: [
        './styles/scholar_green/ref1.png',
        './styles/scholar_green/ref2.png',
        './styles/scholar_green/ref3.png',
        './styles/scholar_green/ref4.png',
        './styles/scholar_green/ref5.png',
        './styles/scholar_green/ref6.png',
        './styles/scholar_green/ref7.png'
      ],
      suffix: '---ä»¥ä¸Šæ˜¯ç”¨æˆ·è¾“å…¥çš„ç”ŸæˆPPTçš„æç¤ºè¯ã€‚ä»¥ä¸‹æ˜¯ä½ è¦éµå¾ªçš„ç³»ç»Ÿæç¤ºè¯ï¼šè¯·å¸®ç”¨æˆ·ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œç”¨æˆ·ä¼šæŠŠè¿™ä¸ªå›¾ç‰‡ç›´æ¥æ’å…¥åˆ°PPTé‡Œï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¯´æ˜ï¼Œé»˜è®¤ä½¿ç”¨ä¸­æ–‡ã€‚ä½ éœ€è¦å‚è€ƒé£æ ¼å›¾çš„é¢œè‰²ä¸è‰²å½©é£æ ¼ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç»“åˆç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ç”ŸæˆPPTï¼Œç”¨å¹³é¢è®¾è®¡ä¸“å®¶çš„è§’åº¦ï¼Œé‡‡ç”¨ç¾è§‚çš„å›¾æ ‡ä»¥åŠç´§å‡‘çš„å¸ƒå±€ï¼Œéµå¾ªæœ€ä½³çš„å¹³é¢è®¾è®¡åŸç†ï¼Œæ–‡å­—ä¸èƒ½è¢«å‹æ‰æˆ–ç¼©çª„ã€‚è¯·ä½ ç›´æ¥ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œè¾¹ç¼˜ä¸è¦æœ‰å¤šä½™çš„è¾¹æ¡†æˆ–è€…æ˜¯ç™½è¾¹ï¼Œ4kåˆ†è¾¨ç‡ã€‚å½“å‰éœ€è¦ç”Ÿæˆçš„é¡µé¢å†…å®¹ï¼šå¦‚æœç”¨æˆ·çš„æç¤ºè¯éå¸¸è¯¦å®ï¼Œç›´æ¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„å†…å®¹æ¥ç”ŸæˆPPTï¼›å¦‚æœç”¨æˆ·çš„æç¤ºè¯è¿‡äºç®€å•ï¼Œä¸è¶³ä»¥ç”Ÿæˆç´§å‡‘ã€å†…å®¹å……å®çš„PPTï¼Œè¯·å…ˆä½¿ç”¨ä½ çš„ä¸“ä¸šçŸ¥è¯†å®Œå–„PPTçš„ä¸»é¢˜å†…å®¹ï¼Œå†ç”Ÿæˆæœ€ç»ˆçš„PPTã€‚æ— è®ºå“ªç§åœºæ™¯ï¼Œéƒ½è¦å®Œå…¨ä½¿ç”¨ç”¨æˆ·æä¾›çš„æ•°æ®å’Œä¸“ä¸šåè¯ï¼Œä¸è¦è‡ªå·±ç¼–é€ æ•°æ®ã€‚ä½ éœ€è¦è¿”å›3å¼ å›¾ç‰‡ï¼Œç¬¬1å¼ æ˜¯å®Œæ•´çš„PPTå†…å®¹ï¼›ç¬¬2å¼ æ˜¯PPTé‡Œæ‰€æœ‰çš„å›¾åƒå’ŒèƒŒæ™¯å›¾çš„ç»„åˆï¼Œæ²¡æœ‰ä»»ä½•æ–‡å­—ï¼›ç¬¬3å¼ æ˜¯PPTé‡Œçš„æ‰€æœ‰æ–‡å­—ï¼Œé€æ˜èƒŒæ™¯ã€‚'
    },
    {
      id: 'simple_business',
      title: 'ç®€çº¦å•†åŠ¡',
      preview: './styles/simple_business/preview.png',
      refs: [
        './styles/simple_business/ref1.png',
        './styles/simple_business/ref2.png',
        './styles/simple_business/ref3.png',
        './styles/simple_business/ref4.png',
        './styles/simple_business/ref5.png'
      ],
      suffix: '---ä»¥ä¸Šæ˜¯ç”¨æˆ·è¾“å…¥çš„ç”ŸæˆPPTçš„æç¤ºè¯ã€‚ä»¥ä¸‹æ˜¯ä½ è¦éµå¾ªçš„ç³»ç»Ÿæç¤ºè¯ï¼šè¯·å¸®ç”¨æˆ·ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œç”¨æˆ·ä¼šæŠŠè¿™ä¸ªå›¾ç‰‡ç›´æ¥æ’å…¥åˆ°PPTé‡Œï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¯´æ˜ï¼Œé»˜è®¤ä½¿ç”¨ä¸­æ–‡ã€‚ä½ éœ€è¦å‚è€ƒé£æ ¼å›¾çš„é¢œè‰²ä¸è‰²å½©é£æ ¼ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç»“åˆç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ç”ŸæˆPPTï¼Œç”¨å¹³é¢è®¾è®¡ä¸“å®¶çš„è§’åº¦ï¼Œé‡‡ç”¨ç¾è§‚çš„å›¾æ ‡ä»¥åŠç®€æ´ç°ä»£çš„å¸ƒå±€ï¼Œéµå¾ªæœ€ä½³çš„å¹³é¢è®¾è®¡åŸç†ï¼Œæ–‡å­—ä¸èƒ½è¢«å‹æ‰æˆ–ç¼©çª„ã€‚è¯·ä½ ç›´æ¥ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œè¾¹ç¼˜ä¸è¦æœ‰å¤šä½™çš„è¾¹æ¡†æˆ–è€…æ˜¯ç™½è¾¹ï¼Œ4kåˆ†è¾¨ç‡ã€‚å½“å‰éœ€è¦ç”Ÿæˆçš„é¡µé¢å†…å®¹ï¼šå¦‚æœç”¨æˆ·çš„æç¤ºè¯éå¸¸è¯¦å®ï¼Œç›´æ¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„å†…å®¹æ¥ç”ŸæˆPPTï¼›å¦‚æœç”¨æˆ·çš„æç¤ºè¯è¿‡äºç®€å•ï¼Œè¯·å…ˆä½¿ç”¨ä½ çš„ä¸“ä¸šçŸ¥è¯†å®Œå–„PPTçš„ä¸»é¢˜å†…å®¹ï¼Œå†ç”Ÿæˆæœ€ç»ˆçš„PPTã€‚æ— è®ºå“ªç§åœºæ™¯ï¼Œéƒ½è¦å®Œå…¨ä½¿ç”¨ç”¨æˆ·æä¾›çš„æ•°æ®å’Œä¸“ä¸šåè¯ï¼Œä¸è¦è‡ªå·±ç¼–é€ æ•°æ®ã€‚ä½ éœ€è¦è¿”å›3å¼ å›¾ç‰‡ï¼Œç¬¬1å¼ æ˜¯å®Œæ•´çš„PPTå†…å®¹ï¼›ç¬¬2å¼ æ˜¯PPTé‡Œæ‰€æœ‰çš„å›¾åƒå’ŒèƒŒæ™¯å›¾çš„ç»„åˆï¼Œæ²¡æœ‰ä»»ä½•æ–‡å­—ï¼›ç¬¬3å¼ æ˜¯PPTé‡Œçš„æ‰€æœ‰æ–‡å­—ï¼Œé€æ˜èƒŒæ™¯ã€‚'
    },
    {
      id: 'simple_colorful',
      title: 'ç®€çº¦å¤šå½©',
      preview: './styles/simple_colorful/preview.png',
      refs: [
        './styles/simple_colorful/ref1.png',
        './styles/simple_colorful/ref2.png',
        './styles/simple_colorful/ref3.png',
        './styles/simple_colorful/ref4.png',
        './styles/simple_colorful/ref5.png',
        './styles/simple_colorful/ref6.png'
      ],
      suffix: '---ä»¥ä¸Šæ˜¯ç”¨æˆ·è¾“å…¥çš„ç”ŸæˆPPTçš„æç¤ºè¯ã€‚ä»¥ä¸‹æ˜¯ä½ è¦éµå¾ªçš„ç³»ç»Ÿæç¤ºè¯ï¼šè¯·å¸®ç”¨æˆ·ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œç”¨æˆ·ä¼šæŠŠè¿™ä¸ªå›¾ç‰‡ç›´æ¥æ’å…¥åˆ°PPTé‡Œï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¯´æ˜ï¼Œé»˜è®¤ä½¿ç”¨ä¸­æ–‡ã€‚ä½ éœ€è¦å‚è€ƒé£æ ¼å›¾çš„é¢œè‰²ä¸è‰²å½©é£æ ¼ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç»“åˆç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ç”ŸæˆPPTï¼Œç”¨å¹³é¢è®¾è®¡ä¸“å®¶çš„è§’åº¦ï¼Œé‡‡ç”¨ç¾è§‚çš„å›¾æ ‡ä»¥åŠç®€æ´ç°ä»£çš„å¸ƒå±€ï¼Œéµå¾ªæœ€ä½³çš„å¹³é¢è®¾è®¡åŸç†ï¼Œæ–‡å­—ä¸èƒ½è¢«å‹æ‰æˆ–ç¼©çª„ã€‚è¯·ä½ ç›´æ¥ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œè¾¹ç¼˜ä¸è¦æœ‰å¤šä½™çš„è¾¹æ¡†æˆ–è€…æ˜¯ç™½è¾¹ï¼Œ4kåˆ†è¾¨ç‡ã€‚å½“å‰éœ€è¦ç”Ÿæˆçš„é¡µé¢å†…å®¹ï¼šå¦‚æœç”¨æˆ·çš„æç¤ºè¯éå¸¸è¯¦å®ï¼Œç›´æ¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„å†…å®¹æ¥ç”ŸæˆPPTï¼›å¦‚æœç”¨æˆ·çš„æç¤ºè¯è¿‡äºç®€å•ï¼Œè¯·å…ˆä½¿ç”¨ä½ çš„ä¸“ä¸šçŸ¥è¯†å®Œå–„PPTçš„ä¸»é¢˜å†…å®¹ï¼Œå†ç”Ÿæˆæœ€ç»ˆçš„PPTã€‚æ— è®ºå“ªç§åœºæ™¯ï¼Œéƒ½è¦å®Œå…¨ä½¿ç”¨ç”¨æˆ·æä¾›çš„æ•°æ®å’Œä¸“ä¸šåè¯ï¼Œä¸è¦è‡ªå·±ç¼–é€ æ•°æ®ã€‚ä½ éœ€è¦è¿”å›3å¼ å›¾ç‰‡ï¼Œç¬¬1å¼ æ˜¯å®Œæ•´çš„PPTå†…å®¹ï¼›ç¬¬2å¼ æ˜¯PPTé‡Œæ‰€æœ‰çš„å›¾åƒå’ŒèƒŒæ™¯å›¾çš„ç»„åˆï¼Œæ²¡æœ‰ä»»ä½•æ–‡å­—ï¼›ç¬¬3å¼ æ˜¯PPTé‡Œçš„æ‰€æœ‰æ–‡å­—ï¼Œé€æ˜èƒŒæ™¯ã€‚'
    },
    {
      id: 'modern_illustration',
      title: 'ç°ä»£æ’ç”»',
      preview: './styles/modern_illustration/preview.png',
      refs: [
        './styles/modern_illustration/ref1.png',
        './styles/modern_illustration/ref2.png',
        './styles/modern_illustration/ref3.png',
        './styles/modern_illustration/ref4.png',
        './styles/modern_illustration/ref5.png',
        './styles/modern_illustration/ref6.png'
      ],
      suffix: '---ä»¥ä¸Šæ˜¯ç”¨æˆ·è¾“å…¥çš„ç”ŸæˆPPTçš„æç¤ºè¯ã€‚ä»¥ä¸‹æ˜¯ä½ è¦éµå¾ªçš„ç³»ç»Ÿæç¤ºè¯ï¼šè¯·å¸®ç”¨æˆ·ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œç”¨æˆ·ä¼šæŠŠè¿™ä¸ªå›¾ç‰‡ç›´æ¥æ’å…¥åˆ°PPTé‡Œï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¯´æ˜ï¼Œé»˜è®¤ä½¿ç”¨ä¸­æ–‡ã€‚ä½ éœ€è¦å‚è€ƒé£æ ¼å›¾çš„é¢œè‰²ä¸è‰²å½©é£æ ¼ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç»“åˆç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ç”ŸæˆPPTï¼Œç”¨å¹³é¢è®¾è®¡ä¸“å®¶çš„è§’åº¦ï¼Œé‡‡ç”¨ç¾è§‚çš„å›¾æ ‡ä»¥åŠå®½æ¾ã€ç®€ä»‹çš„å¸ƒå±€ï¼Œéµå¾ªæœ€ä½³çš„å¹³é¢è®¾è®¡åŸç†ï¼Œæ–‡å­—ä¸èƒ½è¢«å‹æ‰æˆ–ç¼©çª„ï¼Œé…å›¾æ˜¯ç°ä»£ç®€çº¦çš„æ’ç”»é£æ ¼ã€‚è¯·ä½ ç›´æ¥ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œè¾¹ç¼˜ä¸è¦æœ‰å¤šä½™çš„è¾¹æ¡†æˆ–è€…æ˜¯ç™½è¾¹ï¼Œ4kåˆ†è¾¨ç‡ã€‚å½“å‰éœ€è¦ç”Ÿæˆçš„é¡µé¢å†…å®¹ï¼šå¦‚æœç”¨æˆ·çš„æç¤ºè¯éå¸¸è¯¦å®ï¼Œç›´æ¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„å†…å®¹æ¥ç”ŸæˆPPTï¼›å¦‚æœç”¨æˆ·çš„æç¤ºè¯è¿‡äºç®€å•ï¼Œè¯·å…ˆä½¿ç”¨ä½ çš„ä¸“ä¸šçŸ¥è¯†å®Œå–„PPTçš„ä¸»é¢˜å†…å®¹ï¼Œå†ç”Ÿæˆæœ€ç»ˆçš„PPTã€‚æ— è®ºå“ªç§åœºæ™¯ï¼Œéƒ½è¦å®Œå…¨ä½¿ç”¨ç”¨æˆ·æä¾›çš„æ•°æ®å’Œä¸“ä¸šåè¯ï¼Œä¸è¦è‡ªå·±ç¼–é€ æ•°æ®ã€‚ä½ éœ€è¦è¿”å›3å¼ å›¾ç‰‡ï¼Œç¬¬1å¼ æ˜¯å®Œæ•´çš„PPTå†…å®¹ï¼›ç¬¬2å¼ æ˜¯PPTé‡Œæ‰€æœ‰çš„å›¾åƒå’ŒèƒŒæ™¯å›¾çš„ç»„åˆï¼Œæ²¡æœ‰ä»»ä½•æ–‡å­—ï¼›ç¬¬3å¼ æ˜¯PPTé‡Œçš„æ‰€æœ‰æ–‡å­—ï¼Œé€æ˜èƒŒæ™¯ã€‚'
    },
    {
      id: 'party1',
      title: 'å…šå»ºçº¢è‰²',
      preview: './styles/party1/preview.png',
      refs: [
        './styles/party1/ref1.png',
        './styles/party1/ref2.png',
        './styles/party1/ref3.png',
        './styles/party1/ref4.png',
        './styles/party1/ref5.png',
        './styles/party1/ref6.png'
      ],
      suffix: '---ä»¥ä¸Šæ˜¯ç”¨æˆ·è¾“å…¥çš„ç”ŸæˆPPTçš„æç¤ºè¯ã€‚ä»¥ä¸‹æ˜¯ä½ è¦éµå¾ªçš„ç³»ç»Ÿæç¤ºè¯ï¼šè¯·å¸®ç”¨æˆ·ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œç”¨æˆ·ä¼šæŠŠè¿™ä¸ªå›¾ç‰‡ç›´æ¥æ’å…¥åˆ°PPTé‡Œï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¯´æ˜ï¼Œé»˜è®¤ä½¿ç”¨ä¸­æ–‡ã€‚ä½ éœ€è¦å‚è€ƒé£æ ¼å›¾çš„é¢œè‰²ä¸è‰²å½©é£æ ¼ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šç»“åˆç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ç”ŸæˆPPTï¼Œç”¨å¹³é¢è®¾è®¡ä¸“å®¶çš„è§’åº¦ï¼Œé‡‡ç”¨ç¾è§‚çš„å›¾æ ‡ä»¥åŠç®€æ´çš„å¸ƒå±€ï¼Œéµå¾ªæœ€ä½³çš„å¹³é¢è®¾è®¡åŸç†ï¼Œæ–‡å­—ä¸èƒ½è¢«å‹æ‰æˆ–ç¼©çª„ï¼Œå°¤å…¶ä¾§é‡ä¸­å›½å…šå»ºçº¢è‰²çš„é£æ ¼ã€‚è¯·ä½ ç›´æ¥ç”ŸæˆPPTå•é¡µæˆªå›¾ï¼Œè¾¹ç¼˜ä¸è¦æœ‰å¤šä½™çš„è¾¹æ¡†æˆ–è€…æ˜¯ç™½è¾¹ï¼Œ4kåˆ†è¾¨ç‡ã€‚å½“å‰éœ€è¦ç”Ÿæˆçš„é¡µé¢å†…å®¹ï¼šå¦‚æœç”¨æˆ·çš„æç¤ºè¯éå¸¸è¯¦å®ï¼Œç›´æ¥ä½¿ç”¨ç”¨æˆ·æä¾›çš„å†…å®¹æ¥ç”ŸæˆPPTï¼›å¦‚æœç”¨æˆ·çš„æç¤ºè¯è¿‡äºç®€å•ï¼Œä¸è¶³ä»¥ç”Ÿæˆç´§å‡‘ã€å†…å®¹å……å®çš„PPTï¼Œè¯·å…ˆä½¿ç”¨ä½ çš„ä¸“ä¸šçŸ¥è¯†å®Œå–„PPTçš„ä¸»é¢˜å†…å®¹ï¼Œå†ç”Ÿæˆæœ€ç»ˆçš„PPTã€‚æ— è®ºå“ªç§åœºæ™¯ï¼Œéƒ½è¦å®Œå…¨ä½¿ç”¨ç”¨æˆ·æä¾›çš„æ•°æ®å’Œä¸“ä¸šåè¯ï¼Œä¸è¦è‡ªå·±ç¼–é€ æ•°æ®ã€‚ä½ éœ€è¦è¿”å›3å¼ å›¾ç‰‡ï¼Œç¬¬1å¼ æ˜¯å®Œæ•´çš„PPTå†…å®¹ï¼›ç¬¬2å¼ æ˜¯PPTé‡Œæ‰€æœ‰çš„å›¾åƒå’ŒèƒŒæ™¯å›¾çš„ç»„åˆï¼Œæ²¡æœ‰ä»»ä½•æ–‡å­—ï¼›ç¬¬3å¼ æ˜¯PPTé‡Œçš„æ‰€æœ‰æ–‡å­—ï¼Œé€æ˜èƒŒæ™¯ã€‚'
    },
  ];

  // ================= åŸºç¡€é…ç½® =================
  const PUBLIC_R2_DOMAIN = 'https://cdn.gordensun.com/bananaproimage'; 
  const ENDPOINT = 'https://hk-api.gptbest.vip/v1/images/generations';
  const MODEL = 'nano-banana-2'; 
  const STORE_KEY = 'nb_ppt_v3:key';

  // çŠ¶æ€å˜é‡
  let activeCustomImages = [];   // ç”¨æˆ·æ‰‹åŠ¨ä¸Šä¼ çš„ (Base64)
  let activeStyleImages = [];    // é€‰ä¸­é£æ ¼è‡ªåŠ¨åŠ è½½çš„ (Base64)
  let currentStyle = null;       // å½“å‰é€‰ä¸­é£æ ¼å¯¹è±¡
  let lbUrl = '';

  // UI
  const ui = {
    prompt: document.getElementById('prompt'),
    enhancementToggle: document.getElementById('enhancementToggle'),
    ratio: document.getElementById('ratioSelect'),
    size: document.getElementById('sizeSelect'),
    key: document.getElementById('userKey'),
    saveKey: document.getElementById('saveKey'),
    styleList: document.getElementById('styleList'),
    dropArea: document.getElementById('dropArea'),
    fileInput: document.getElementById('fileInput'),
    thumbs: document.getElementById('thumbs'),
    go: document.getElementById('go'),
    btnText: document.getElementById('btnText'),
    spin: document.getElementById('spin'),
    status: document.getElementById('status'),
    gallery: document.getElementById('gallery'),
    lb: document.getElementById('lightbox'),
    lbImg: document.getElementById('lbImg'),
    lbDownBtn: document.getElementById('lbDownBtn')
  };

  ui.key.value = localStorage.getItem(STORE_KEY) || '';

  // æ¸²æŸ“é£æ ¼åˆ—è¡¨
  ui.styleList.innerHTML = PPT_STYLES.map(s => `
    <div class="style-card" id="style-${s.id}" onclick="selectStyle('${s.id}')">
      <img src="${s.preview}" onerror="this.src='https://placehold.co/300x168/222/999?text=${s.title}'">
      <div class="style-actions">
        <div class="icon-btn" onclick="event.stopPropagation(); viewLarge('${s.preview}')" title="æŸ¥çœ‹é¢„è§ˆå¤§å›¾">ğŸ”</div>
      </div>
      <div class="style-name">${s.title}</div>
    </div>
  `).join('');

  // ================= é€»è¾‘ï¼šé£æ ¼é€‰æ‹© (è‡ªåŠ¨åŠ è½½Refs) =================
  window.selectStyle = async (id) => {
    // 1. å¦‚æœç‚¹å‡»å·²é€‰ä¸­çš„ï¼Œåˆ™å–æ¶ˆ
    if (currentStyle && currentStyle.id === id) {
      currentStyle = null;
      activeStyleImages = [];
      document.querySelectorAll('.style-card').forEach(c => c.classList.remove('active'));
      msg('å·²å–æ¶ˆé£æ ¼');
      return;
    }

    // 2. äº’æ–¥ï¼šæ¸…ç©ºè‡ªå®šä¹‰ä¸Šä¼ 
    activeCustomImages = [];
    renderThumbs(); // æ¸…ç©ºä¸Šä¼ åŒºåŸŸæ˜¾ç¤º
    ui.dropArea.classList.remove('active');

    // 3. é€‰ä¸­ UI
    currentStyle = PPT_STYLES.find(s => s.id === id);
    document.querySelectorAll('.style-card').forEach(c => c.classList.remove('active'));
    const card = document.getElementById(`style-${id}`);
    card.classList.add('active');
    
    // 4. å¼‚æ­¥åŠ è½½è¯¥é£æ ¼çš„ Ref å›¾ç‰‡
    msg('æ­£åœ¨åŠ è½½é£æ ¼å‚è€ƒå›¾...', false);
    card.classList.add('loading');
    
    try {
      // å¹¶è¡Œä¸‹è½½æ‰€æœ‰å‚è€ƒå›¾å¹¶è½¬ Base64
      const promises = currentStyle.refs.map(url => urlToBase64(url));
      activeStyleImages = await Promise.all(promises);
      msg(`é£æ ¼ [${currentStyle.title}] å·²åŠ è½½ (${activeStyleImages.length} å¼ å‚è€ƒå›¾)`);
    } catch (e) {
      console.error(e);
      msg('åŠ è½½å‚è€ƒå›¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥è·¯å¾„', true);
      activeStyleImages = [];
    } finally {
      card.classList.remove('loading');
    }
  };

  // ================= é€»è¾‘ï¼šè‡ªå®šä¹‰ä¸Šä¼  (äº’æ–¥) =================
  ui.dropArea.onclick = () => ui.fileInput.click();
  ui.fileInput.onchange = (e) => handleFiles(e.target.files);
  ui.dropArea.ondragover = (e) => { e.preventDefault(); ui.dropArea.style.background = 'rgba(255,255,255,0.1)'; };
  ui.dropArea.ondragleave = (e) => { e.preventDefault(); ui.dropArea.style.background = ''; };
  ui.dropArea.ondrop = (e) => { e.preventDefault(); ui.dropArea.style.background = ''; handleFiles(e.dataTransfer.files); };

  async function handleFiles(files) {
    const list = Array.from(files).filter(f => f.type.startsWith('image/'));
    if(!list.length) return;

    // äº’æ–¥ï¼šå–æ¶ˆé£æ ¼
    currentStyle = null;
    activeStyleImages = [];
    document.querySelectorAll('.style-card').forEach(c => c.classList.remove('active'));

    if(activeCustomImages.length + list.length > 8) return msg('æœ€å¤šä¸Šä¼  8 å¼ ', true);
    for(let f of list) {
      activeCustomImages.push(await fileToBase64(f));
    }
    renderThumbs();
    ui.dropArea.classList.add('active');
    msg(`å·²åŠ è½½è‡ªå®šä¹‰å‚è€ƒå›¾ (${activeCustomImages.length} å¼ )`);
  }

  function renderThumbs() {
    ui.thumbs.innerHTML = activeCustomImages.map((src, i) => `
      <div class="thumb"><img src="${src}"><div class="del" onclick="removeThumb(${i})">âœ•</div></div>
    `).join('');
    if(activeCustomImages.length === 0) ui.dropArea.classList.remove('active');
  }

  window.removeThumb = (i) => { event.stopPropagation(); activeCustomImages.splice(i, 1); renderThumbs(); };


  // ================= æ ¸å¿ƒç”Ÿæˆ =================
  ui.saveKey.onclick = () => { localStorage.setItem(STORE_KEY, ui.key.value.trim()); msg('Key å·²ä¿å­˜'); };

  ui.go.onclick = async () => {
    const promptRaw = ui.prompt.value.trim();
    const key = ui.key.value.trim();
    if(!key) return msg('è¯·å¡«å†™ Key', true);
    
    // ä¿®æ”¹ç‚¹ï¼šå…è®¸æ‰€æœ‰è¾“å…¥ä¸ºç©ºï¼Œå»é™¤åŸæ¥çš„é˜»æ­¢é€»è¾‘

    // 1. ç¡®å®š Prompt ä¸ åç¼€
    let finalPrompt = promptRaw;
    let usedStyleName = 'è‡ªå®šä¹‰';
    const useEnhancement = ui.enhancementToggle.checked;
    const genericSuffix = "ã€‚---ä»¥ä¸Šæ˜¯ç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ï¼Œæ ¹æ®ç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ç”Ÿæˆå•é¡µPPTã€‚";

    // ä¿®æ”¹ç‚¹ï¼šå¦‚æœæç¤ºè¯ä¸ºç©ºï¼Œç»™äºˆä¸€ä¸ªé»˜è®¤åŸºç¡€æè¿°ï¼Œé˜²æ­¢APIæŠ¥é”™ï¼ŒåŒæ—¶ä½œä¸ºå…œåº•
    if (!finalPrompt) {
      finalPrompt = "high quality ppt slide background, professional design";
    }

    if (useEnhancement) {
      // å¼€å¯å¢å¼ºï¼šå¦‚æœæœ‰é£æ ¼æ¨¡æ¿ï¼Œä½¿ç”¨æ¨¡æ¿ç‰¹å®š suffix
      if (currentStyle) {
        finalPrompt += currentStyle.suffix;
        usedStyleName = currentStyle.title;
      }
      // å¦‚æœæ— é£æ ¼ï¼Œä»…ä¿ç•™ä¸Šé¢çš„é»˜è®¤finalPromptå³å¯
    } else {
      // å…³é—­å¢å¼ºï¼šç»Ÿä¸€ä½¿ç”¨é€šç”¨åç¼€
      finalPrompt += genericSuffix;
      if(currentStyle) usedStyleName = currentStyle.title;
    }

    // 2. ç¡®å®šä½¿ç”¨å“ªç»„å‚è€ƒå›¾ (äº’æ–¥é€»è¾‘å·²ä¿è¯ activeStyleImages å’Œ activeCustomImages ä¸ä¼šåŒæ—¶å­˜åœ¨)
    const imagesToSend = currentStyle ? activeStyleImages : activeCustomImages;

    setLoading(true);
    msg(`æ­£åœ¨è®¾è®¡ [${usedStyleName}] é£æ ¼...`);

    try {
      const payload = {
        model: MODEL,
        prompt: finalPrompt,
        // ä¿®æ”¹ç‚¹ï¼šç¡®ä¿é»˜è®¤ 16:9
        aspect_ratio: ui.ratio.value || "16:9",
        image_size: ui.size.value
      };
      
      // å¦‚æœæœ‰å›¾ç‰‡ï¼ŒåŠ å…¥ Payload
      if (imagesToSend.length > 0) {
        payload.image = imagesToSend;
      }

      const res = await fetch(ENDPOINT, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + key },
        body: JSON.stringify(payload)
      });

      if(!res.ok) {
        let errStr = `Error ${res.status}`;
        try { const j = await res.json(); if(j.error && j.error.message) errStr = j.error.message; } catch(e){}
        throw new Error(errStr);
      }

      const data = await res.json();
      const urls = (data.data || []).map(i => fixR2Url(i.url));
      if(urls.length) {
        msg('è®¾è®¡å®Œæˆ');
        addGallery(urls, finalPrompt);
      } else {
        throw new Error('æœªè¿”å›å›¾ç‰‡');
      }
    } catch(err) {
      console.error(err);
      msg(err.message, true);
    } finally {
      setLoading(false);
    }
  };

  // ================= Utils =================
  function fixR2Url(url) {
    if(!url || !PUBLIC_R2_DOMAIN) return url;
    try {
      const u = new URL(url);
      if(u.hostname.includes('r2.cloudflarestorage.com')) {
        return PUBLIC_R2_DOMAIN.replace(/\/$/, '') + u.pathname.replace('/bananaproimage/', '/');
      }
    } catch(e){}
    return url;
  }

  function setLoading(ing) {
    ui.go.disabled = ing;
    ui.spin.style.display = ing ? 'block' : 'none';
    ui.btnText.textContent = ing ? 'AI ç»˜åˆ¶ä¸­...' : 'ç«‹å³ç”Ÿæˆ';
  }

  function msg(text, err=false) {
    ui.status.textContent = text;
    ui.status.style.color = err ? '#ff6b6b' : 'var(--accent)';
  }

  function addGallery(urls, prompt) {
    const time = new Date().toLocaleTimeString();
    const html = `
      <div class="result-group">
        <div class="result-meta">
          <span>${time}</span>
          <button class="btn-copy" onclick="copyTxt(this, '${prompt.replace(/"/g, '&quot;')}')">å¤åˆ¶ Prompt</button>
        </div>
        <div class="grid-imgs">
          ${urls.map(url => `
            <div class="img-card">
              <img src="${url}" loading="lazy" onclick="viewLarge('${url}', true)">
              <div class="img-actions">
                <button class="action-btn" onclick="viewLarge('${url}', true)" title="é¢„è§ˆ">ğŸ‘</button>
                <button class="action-btn" onclick="download('${url}')" title="ä¸‹è½½">â†“</button>
              </div>
            </div>
          `).join('')}
        </div>
      </div>
    `;
    ui.gallery.insertAdjacentHTML('afterbegin', html);
  }

  // Lightbox
  window.viewLarge = (url, showDownload = false) => {
    lbUrl = url;
    ui.lbImg.src = url;
    ui.lb.classList.add('show');
    ui.lbDownBtn.style.display = showDownload ? 'block' : 'none';
  };
  window.closeLightbox = () => ui.lb.classList.remove('show');
  window.downloadCurrent = () => { if(lbUrl) download(lbUrl); };
  window.download = async (url) => {
    try {
      const res = await fetch(url);
      const blob = await res.blob();
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = `ppt-${Date.now()}.png`;
      document.body.appendChild(a); a.click(); a.remove();
    } catch(e) { window.open(url, '_blank'); }
  };
  window.copyTxt = (btn, txt) => {
    navigator.clipboard.writeText(txt);
    const old = btn.innerText; btn.innerText = 'å·²å¤åˆ¶'; setTimeout(() => btn.innerText = old, 1500);
  };

  // Base64 Helpers
  const fileToBase64 = f => new Promise((r) => { const reader = new FileReader(); reader.onload = () => r(reader.result); reader.readAsDataURL(f); });
  
  // æ–°å¢ï¼šå°† URL å›¾ç‰‡è½¬æ¢ä¸º Base64 (ç”¨äºé£æ ¼å‚è€ƒå›¾)
  const urlToBase64 = async (url) => {
    const res = await fetch(url);
    const blob = await res.blob();
    return await fileToBase64(blob);
  };

})();
</script>
</body>
</html>
